<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>WSF: WSF Source</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">WSF
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('wsfsource.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">WSF Source </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="wsfsrcsec"></a>
Whelchel Sound Format Source</h1>
<p>Yes, the WSF format <em>is</em> opensource. For exmaples see <a class="el" href="wsfsource.html#wsfincode">WSF Code Usage</a></p>
<h2><a class="anchor" id="getsrc"></a>
Obtaining the Source</h2>
<p><a href="http://www.github.com/soundofjw/WSF">github.com</a></p>
<h2><a class="anchor" id="aboutsrc"></a>
About the Source</h2>
<p>The WSF mainframe is a portable set of classes, consiting of <a class="el" href="class_c_w_s_f_mod.html">CWSFMod</a> and <a class="el" href="class_c_w_s_f_pack.html">CWSFPack</a> along with loading classes derived <a class="el" href="class_c_base_loader.html" title="Base class for loading and saving of modules.">CBaseLoader</a>. One such class is <a class="el" href="class_c_s3_m_loader.html">CS3MLoader</a>.<br/>
</p>
<p>The main files you'll need for using the WSF format are</p>
<ul>
<li><a class="el" href="_w_s_f_glob_8h.html">WSFGlob.h</a><br/>
 Global Definitions</li>
</ul>
<ul>
<li><a class="el" href="_w_s_f_mod_8cpp.html">WSFMod.cpp</a> + <a class="el" href="_w_s_f_mod_8h.html">WSFMod.h</a><br/>
 Base MOD Handling Functions + <a class="el" href="class_c_w_s_f_ascii.html">CWSFAscii</a></li>
</ul>
<ul>
<li><a class="el" href="_w_s_f_pack_8cpp.html">WSFPack.cpp</a> + <a class="el" href="_w_s_f_pack_8h.html">WSFPack.h</a><br/>
 WSFPack Handling Functions (<a class="el" href="class_c_w_s_f_pack.html">CWSFPack</a>)</li>
</ul>
<ul>
<li><a class="el" href="_w_s_f_loaders_8cpp.html">WSFLoaders.cpp</a><br/>
 WSFLoaders : <a class="el" href="class_c_i_t_loader.html">CITLoader</a> + <a class="el" href="class_c_s3_m_loader.html">CS3MLoader</a> + <a class="el" href="class_c_w_s_f_loader.html">CWSFLoader</a> + others as added</li>
</ul>
<ul>
<li><a class="el" href="_w_s_f_comp_8c.html">WSFComp.c</a> + <a class="el" href="_w_s_f_comp_8h.html">WSFComp.h</a><br/>
 Compression Handling for <a class="el" href="class_c_w_s_f_pack.html">CWSFPack</a> and <a class="el" href="class_c_w_s_f_loader.html">CWSFLoader</a></li>
</ul>
<p>Any loaders you create for yourself may go in a seperate file that includes <a class="el" href="_w_s_f_mod_8h.html">WSFMod.h</a> and must be a child of <a class="el" href="class_c_base_loader.html" title="Base class for loading and saving of modules.">CBaseLoader</a><br/>
</p>
<h2><a class="anchor" id="includesrc"></a>
Including WSF in your project</h2>
<p>To include WSF in your project, you will simply need to compile and link the above *.c* (.cpp + .c) files with your project, and include the requested .h files. If you don't need one of the above features, simply do not include it in your linking (.c).<br/>
</p>
<p>An alternative is <a class="el" href="wsflibpage.html">WSFLib</a> <br/>
</p>
<h1><a class="anchor" id="wsfloaders"></a>
Creating a WSF Loader</h1>
<p>This section explains how to create your own file loader for WSF.<br/>
<br/>
</p>
<ol>
<li>
<p class="startli"><b>Add to the WSFModVers enum</b><br/>
 First, in the <a class="el" href="_w_s_f_mod_8h.html#a22ae4067d084b1d848d1641a082cb718">WSFModVers</a> enum (in <a class="el" href="_w_s_f_mod_8h.html">WSFMod.h</a>), create an entry that suits the file format your using best. (eg WSFM_xxx -&gt; WSFM_XM)<br/>
 </p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>Add Description and Extension</b><br/>
 Go to the definition of <a class="el" href="_w_s_f_mod_8h.html#a29b3424d1aa084716e9d477d63fcff30">g_cModExt</a> (<a class="el" href="_w_s_f_mod_8cpp.html">WSFMod.cpp</a>) and add an entry (which is the same placement of your enum entry before) that is the extension of your format. Use the format ".XXX", and do not exclude the '.'<br/>
 In the definition of <a class="el" href="_w_s_f_mod_8h.html#a78120a1ddc2560ce05d5762d5e1f3de8">g_cModDesc</a> do the same as above, but instead create a suitable description for your format. Such as, "Impulse Tracker Module"<br/>
 In the definition of <a class="el" href="_w_s_f_mod_8h.html#ac92308558ee11c23de9b7f2d7f3f6437">g_bModFlag</a> you need to add an entry with the correct placement that suits whether or not your loader is enabled. 1 = TRUE, 0 = FALSE<br/>
 </p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>Create a new Loader Class</b><br/>
 In <a class="el" href="_w_s_f_mod_8h.html">WSFMod.h</a>, after the definition of <a class="el" href="class_c_base_loader.html" title="Base class for loading and saving of modules.">CBaseLoader</a>, you need to create child class of it. Name it something like CxxxLoader, where xxx is the file extension. For instance, the S3M loader is named <a class="el" href="class_c_s3_m_loader.html">CS3MLoader</a>.<br/>
 </p>
<div class="fragment"><div class="line"><span class="keyword">class </span>CxxxLoader : <span class="keyword">public</span> <a class="code" href="class_c_base_loader.html" title="Base class for loading and saving of modules.">CBaseLoader</a></div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Base Function for Loading</span></div>
<div class="line">    <span class="keywordtype">int</span> <a class="code" href="class_c_base_loader.html#a1a62cbfe2940352595d2cb777547e1ce">Load</a>( <a class="code" href="_w_s_f_glob_8h.html#a1bbdc5741cd50c9c7b6bd399d9765b7b" title="WSF Byte.">wsfb</a> *bData, <a class="code" href="_w_s_f_glob_8h.html#aa7cefd24d4e999b49f308f2c2906ec16" title="Unsigned Long Typedef.">wsul</a> nSize, <a class="code" href="structwsf__loaddata__s.html">wsf_loaddata</a> *wLD );</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Base Saving Function</span></div>
<div class="line">    <span class="keywordtype">int</span> <a class="code" href="class_c_base_loader.html#a97fc6f83af9dea0cc5038f7153c61ea6">Save</a>( <a class="code" href="structwsf__modout__s.html" title="WSFMODOUT for use with WriteMod.">wsf_modout</a> *wOut, <a class="code" href="structwsf__loaddata__s.html">wsf_loaddata</a> *wLD );</div>
<div class="line"></div>
<div class="line">    <span class="comment">// Function to get pointers to ACTUAL samples</span></div>
<div class="line">    <span class="keywordtype">int</span> <a class="code" href="class_c_base_loader.html#a07d1fbbb0fa3dbe9f34400aedeea0c9f">GetSamplePointers</a>( <a class="code" href="_w_s_f_glob_8h.html#a1bbdc5741cd50c9c7b6bd399d9765b7b" title="WSF Byte.">wsfb</a> *bData, <a class="code" href="_w_s_f_glob_8h.html#aa7cefd24d4e999b49f308f2c2906ec16" title="Unsigned Long Typedef.">wsul</a> nSize, <a class="code" href="structwsg__gspdata__s.html" title="Structure used for CBaseLoader::GetSamplePointers.">wsf_gspdata</a> *gspData );</div>
<div class="line"></div>
<div class="line">};</div>
</div><!-- fragment --><p> The three functions are REQUIRED functions that must be inherited.<br/>
 </p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>Code the Functions</b><br/>
 In <a class="el" href="_w_s_f_loaders_8cpp.html">WSFLoaders.cpp</a>, or perferably in your own source file, start creating the code. All the functions should return ZERO for success, and NONZERO for failure. The MACROs at the end of <a class="el" href="_w_s_f_mod_8h.html">WSFMod.h</a> should be used for reading and writing. These are:<br/>
 <a class="el" href="_w_s_f_mod_8h.html#a7c579266f650c13327ddb84e62aa6fd9" title="Opens x as buffer for size of y.">MOPEN</a>, <a class="el" href="_w_s_f_mod_8h.html#a12e6b224797e8eb2f99fbd603c06d8d8" title="Same as fread without file pointer.">MREAD</a>, <a class="el" href="_w_s_f_mod_8h.html#ad183d3dca2febae78dca191874ad918f" title="Does the same as fwrite. If you use this, you will need to call MRESET when your done.">MAPP</a>, <a class="el" href="_w_s_f_mod_8h.html#abd7b6fc328a7836570645aff79451403" title="Closes a file that was opened for writing. x should be a *wsfb to recieve data pointer, and y a wsul to recieve its length.">MRESET</a>, <a class="el" href="_w_s_f_mod_8h.html#a5b2371f46b05c633a400285d318aaad9" title="Seeks y bytes from the current position.">MSEEK</a>, <a class="el" href="_w_s_f_mod_8h.html#a893be907341af4774ba7d2f52dda1bc5" title="Seeks y bytes from the beginning of the buffer.">MBEGIN</a>, <a class="el" href="_w_s_f_mod_8h.html#af5668b8a6f972524944d1268049f116a" title="Seeks y bytes backwards from ending of buffer.">MEND</a>, <a class="el" href="_w_s_f_mod_8h.html#a31ab321097468742dc0d78a1176c3ed7" title="Seeks y bytes backwards from the cur position.">MBACK</a><br/>
</p>
<ul>
<li>
<p class="startli"><b>GetSamplePointers</b><br/>
 This function needs to fill a wsf_gspdata structure with the following information:<br/>
</p>
<ul start="10">
<li>
<p class="startli">&lt;U&gt;Number of Samples (nSamples)&lt;/U&gt;<br/>
 Fill this in with the number of samples.<br/>
 </p>
<p class="endli"></p>
</li>
<li>
<p class="startli">&lt;U&gt;Sample Offsets (nSampOffs)&lt;/U&gt;<br/>
 Array of wsul that contains the offsets to the ACTUAL sample data within the file. It should be offset of 0.<br/>
 </p>
<p class="endli"></p>
</li>
<li>
<p class="startli">&lt;U&gt;Sample Sizes (nSampSizes)&lt;/U&gt;<br/>
 Array of wsul that contain the sizes of each of the samples in bytes.<br/>
 </p>
<p class="endli"></p>
</li>
<li>
<p class="startli">&lt;U&gt;Channels, Bits, and InnerSamples (nCh, nBit, nInSamps)&lt;/U&gt;<br/>
 Array of bytes (nInSamps is wsul) that contain the number of channels, bit rate (8 or 16), and number of samples of each sample.<br/>
 If the number of samples isn't stored, you can generally retrieve it like this:<br/>
 </p>
<div class="fragment"><div class="line">nInSamps[i] = nSampSizes[i] / nCh[i] / (nBit[i]/8);</div>
</div><!-- fragment --><p> <br/>
 </p>
<p class="endli"></p>
</li>
</ul>
<p>This function should also be the one to make sure the loader is opening the correct file format.<br/>
 A good example of this code is found at <a class="el" href="class_c_s3_m_loader.html#a9262084af1690cf076f77feaed41bcd5" title="Function to get pointers to ACTUAL samples.">CS3MLoader::GetSamplePointers</a> (<a class="el" href="_w_s_f_loaders_8cpp.html">WSFLoaders.cpp</a>)<br/>
</p>
<dl class="section note"><dt>Note</dt><dd>After you have set the number of samples, you can easily init the memory in the wsf_gspdata structure using <a class="el" href="_w_s_f_mod_8cpp.html#ac309c0c82e49a34b50761657050d6821" title="Inits wsf_gspdata struct. nSamples must be filled first.">InitGSPData()</a>. However, you should not free this on your own.<br/>
</dd>
<dd>
If you perfer to simply add to the number of samples as you go along, then you must run InitGSPData with gspData-&gt;nSamples = 0 and use the function <a class="el" href="_w_s_f_mod_8cpp.html#ab409fc31b49278846f8c659e3d323140" title="Pushes values into gspData (ONLY IF YOU START WITH 0 SAMPLES AND MUST LOAD THROUGH)">PushIntoGSP()</a>.<br/>
</dd></dl>
<p><br/>
 </p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>Load</b><br/>
 This function is mainly responsible for loading the samples into a wsf_sample array, their sizes into a wsul array, and storing the MOD data after the samples have been loaded.<br/>
 This is done by completeing a wsf_loaddata structure. Alot of this however, is very easy considering the GetSamplePointers function should be called to do this.</p>
<ul start="10">
<li>
<p class="startli">&lt;U&gt;Number of Samples (nSamples)&lt;/U&gt;<br/>
 Load this from gspData-&gt;nSamples<br/>
 </p>
<p class="endli"></p>
</li>
<li>
<p class="startli">&lt;U&gt;Samples &amp; Sizes (bSamples &amp; nSampleSizes)&lt;/U&gt;<br/>
 bSamples is an array of wsf_sample which must be filled out for every sample in the file. <b>If the sample size is 0, then DO NOT allocate bSamples[nSamp].bModData!!!</b><br/>
 This data may also be filled out easily from the arrays in wsf_gspdata. </p>
<p class="endli"></p>
</li>
<li>
<p class="startli">&lt;U&gt;Mod Data (bModData + nModSize)&lt;/U&gt;<br/>
 After the samples are loaded, you can easily fill this out with the following code:<br/>
 </p>
<div class="fragment"><div class="line"><span class="comment">// Load MOD data</span></div>
<div class="line">wLD-&gt;bModData = (<a class="code" href="_w_s_f_glob_8h.html#a1bbdc5741cd50c9c7b6bd399d9765b7b" title="WSF Byte.">wsfb</a>*)malloc(nSize);</div>
<div class="line">wLD-&gt;nModSize = nSize;</div>
<div class="line">memcpy(wLD-&gt;bModData,bData,nSize);</div>
</div><!-- fragment --><p> <br/>
 </p>
<p class="endli"></p>
</li>
<li>
<p class="startli">&lt;U&gt;Other Fields (nSubDiff, cTitle, ...)&lt;/U&gt;<br/>
 Most of these are self-explanatory, except nSubDiff and nModType. You should leave nModType alone seeing as it should already be setup, but in case you want to make sure you can set it to the value of the loader's entry in the WSFModVers enum. nSubDiff should be set to 0.<br/>
 </p>
<p class="endli"></p>
</li>
</ul>
<p>Loading is one of the trickier functions. After you call GetSamplePointers, be sure to call FreeGSPData to free the pointer. An example of calling this function shows:<br/>
 </p>
<div class="fragment"><div class="line"><a class="code" href="structwsg__gspdata__s.html" title="Structure used for CBaseLoader::GetSamplePointers.">wsf_gspdata</a> gD;</div>
<div class="line"><span class="keywordflow">if</span> (GetSamplePointers(bData,nSize,&amp;gD)){</div>
<div class="line">    <span class="comment">// Error</span></div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
<div class="line"><a class="code" href="_w_s_f_mod_8cpp.html#ace503dea6650ea609a3363bc29678747" title="Frees a wsf_gspdata structure.">FreeGSPData</a>(&amp;gD);</div>
</div><!-- fragment --><p> <br/>
 </p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>Save</b><br/>
 This function is responsible for saving the data in a wsf_loaddata structure into a memory buffer. Normally, this function does nothing, and the samples are replaced automatically through <a class="el" href="class_c_w_s_f_mod.html#a9a6338a6e8b724121b35a55cfa234891" title="Prepares MOD Data buffer for save.">CWSFMod::ReplaceSamplesForSave()</a>. <b>However</b>, should this function return 1, the entire saving process can be performed in this function. If it returns a value higher than 1, than an error is assumed. You can return 0 and modify the sample data if you need to change the sample data before saving the file (As in <a class="el" href="class_c_x_m_loader.html#a3ec66388199710a4df1d40e231eefe92" title="Base Saving Function.">CXMLoader::Save()</a>)<br/>
 </p>
<p class="endli"></p>
</li>
</ul>
<p></p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>Add Loading Code</b><br/>
 Go to <a class="el" href="_w_s_f_mod_8cpp.html#ade57b63196c550086ec39f8b02fc0636" title="Returns CBaseLoader of mod type.">GetBaseLoader()</a> in <a class="el" href="_w_s_f_mod_8cpp.html">WSFMod.cpp</a> and add a case to create a new of your class.<br/>
 If you made <a class="el" href="class_c_m_o_d_loader.html">CMODLoader</a> for <a class="el" href="_w_s_f_mod_8h.html#aeac16212a79deaac5d6c401904ab7d3ba7f62e2291e0ad07f282d1fbbd6871da6" title="MOD File Format.">WSFM_MOD</a>, you will do the following:<br/>
 </p>
<div class="fragment"><div class="line"><span class="keywordflow">case</span> <a class="code" href="_w_s_f_mod_8h.html#aeac16212a79deaac5d6c401904ab7d3ba7f62e2291e0ad07f282d1fbbd6871da6" title="MOD File Format.">WSFM_MOD</a>:</div>
<div class="line">    xBL = (<a class="code" href="class_c_base_loader.html" title="Base class for loading and saving of modules.">CBaseLoader</a>*) <span class="keyword">new</span> <a class="code" href="class_c_m_o_d_loader.html">CMODLoader</a>;</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
</div><!-- fragment --><p> <br/>
 </p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><b>Add Playing Code</b><br/>
 You can add playing code in WSFPlay.cpp where you see the switch (bType) line. You will regocnize all your favorite WSFModVers enum entries, and you should add your player code in just as it does. If you're format isn't support by the DUMB sound module, which it most likely isn't, then you'll need to change the callback thread and handling after the switch for your specific format.<br/>
 </p>
<p class="endli"></p>
</li>
</ol>
<p>Your WSF Loader should now be complete! Make sure to study the <a class="el" href="class_c_s3_m_loader.html">CS3MLoader</a>, as it is the simplest loader.</p>
<h1><a class="anchor" id="wsfincode"></a>
WSF Code Usage</h1>
<p>This section contains examples and codesnippets.</p>
<h2><a class="anchor" id="general"></a>
Player Example</h2>
<p>Two examples of WSF players are included.<br/>
 WSFPlay.cpp and in_wsf.cpp (Winamp Plugin)</p>
<h2><a class="anchor" id="loading"></a>
Loading WSFs into their original format</h2>
<div class="fragment"><div class="line"><span class="keywordtype">char</span> *cPass;</div>
<div class="line"><a class="code" href="structwsf__modout__s.html" title="WSFMODOUT for use with WriteMod.">wsf_modout</a> g_wO;</div>
<div class="line"><a class="code" href="_w_s_f_glob_8h.html#a1bbdc5741cd50c9c7b6bd399d9765b7b" title="WSF Byte.">wsfb</a> bType;</div>
<div class="line"><a class="code" href="class_c_w_s_f_mod.html">CWSFMod</a> *<a class="code" href="group___w_s_f_tool.html#ga2fc9f362328d7157dda6eae54ed37e99" title="Main CWSFMod.">g_wMod</a>;</div>
<div class="line">g_wMod = <span class="keyword">new</span> <a class="code" href="class_c_w_s_f_mod.html">CWSFMod</a>;</div>
<div class="line"></div>
<div class="line"><span class="comment">// If user gave a password, set it here</span></div>
<div class="line"><span class="keywordflow">if</span> (cPass != NULL)</div>
<div class="line">    g_wMod-&gt;<a class="code" href="class_c_w_s_f_mod.html#a12574c68e971e77e1075bec4627e207e" title="Sets password sum before needing to convert to WSF or back.">SetPassSum</a>(<a class="code" href="_w_s_f_pack_8cpp.html#a09a2ceb306de8ab53ff5d1d4d9fa7d79" title="Converts a string into a number by adding up its bytevals This is used for password protection schemi...">GenerateSum</a>(cPass,strlen(cPass));        </div>
<div class="line"></div>
<div class="line"><span class="comment">// Load the WSF</span></div>
<div class="line"><span class="keywordflow">if</span> (g_wMod-&gt;<a class="code" href="class_c_w_s_f_mod.html#ad16567d8f1ee3ced727be25259b41c9c" title="Loads Mod into buffer.">LoadMod</a>(fn))</div>
<div class="line">    <span class="keywordflow">return</span> 1;</div>
<div class="line"></div>
<div class="line"><span class="comment">// Check to see if there was a password and if we didn&#39;t get one</span></div>
<div class="line"><span class="keywordflow">if</span> (g_wMod-&gt;GetPack()-&gt;<a class="code" href="class_c_w_s_f_pack.html#a4c11a3990b5025fb772de19a396ead25" title="Needs password.">m_nNeedPass</a> &amp;&amp; cPass == NULL)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Notify User</span></div>
<div class="line">    printf(<span class="stringliteral">&quot;ENTER A PASS NEXT TIME?!&quot;</span>);</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">// Get Type</span></div>
<div class="line">bType = <a class="code" href="_w_s_f_mod_8cpp.html#a1b5cb7c2c8321c27878838807e895ca1" title="Get Mod Type.">GetModType</a>();</div>
<div class="line"></div>
<div class="line"><span class="comment">// Load Extract a MOD (nonWSF)</span></div>
<div class="line"><span class="keywordflow">if</span> (g_wMod-&gt;<a class="code" href="class_c_w_s_f_mod.html#a44e0734ecebcffd0568a04acddef7c22">WriteMod</a>(&amp;g_wO,<a class="code" href="_w_s_f_tool_8h.html#aa93f0eb578d23995850d61f7d61c55c1" title="FALSE FLAG.">FALSE</a>))</div>
<div class="line">    <span class="keywordflow">return</span> 1;</div>
<div class="line"></div>
<div class="line"><span class="comment">// Using the bType (which is filled w/ a value from the WSFModVers enum)</span></div>
<div class="line"><span class="comment">// LOAD THE MOD into the modplayer and start the callback thread</span></div>
<div class="line"><span class="comment">// (I reccomend switch (bType) { case WSFM_IT: LoadIT(); break; case WSFM_S3M: LoadS3M(); break; } etc)</span></div>
<div class="line"><span class="comment">// You load using g_wO.bModData and g_wO.nSize</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// Once the module is loaded into its player&#39;s memory, you may free using the code below.</span></div>
<div class="line"><span class="comment">// Its reccomended to do this before the music actually starts playing.</span></div>
<div class="line"><span class="comment">// So you could call this directly after your Load() function.</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// Free the mod</span></div>
<div class="line">g_wMod-&gt;<a class="code" href="class_c_w_s_f_mod.html#a48e618d35017af06d9e8c06812f39999" title="Frees Mod.">FreeMod</a>();</div>
<div class="line"></div>
<div class="line"><span class="comment">// The following line should be omitted if more music will be played from the SAME sample pack</span></div>
<div class="line">g_wMod-&gt;<a class="code" href="class_c_w_s_f_mod.html#aa27d2f952c9031eb445e2e366458b19f" title="Free Pack.">FreePack</a>();</div>
<div class="line"></div>
<div class="line"><span class="comment">// Free the mod data</span></div>
<div class="line">free(g_wO.<a class="code" href="structwsf__modout__s.html#a5cd2bd14e3965cfd166929f662027a4d" title="Mod Buffer.">bModData</a>);</div>
<div class="line">g_wO.<a class="code" href="structwsf__modout__s.html#a7d9f41ef0ea9c5db838a629ce5b4784f" title="Size of bModData.">nSize</a> = 0;</div>
<div class="line"></div>
<div class="line"><span class="keyword">delete</span> <a class="code" href="group___w_s_f_tool.html#ga2fc9f362328d7157dda6eae54ed37e99" title="Main CWSFMod.">g_wMod</a>;</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>Its important that you note the g_wMod-&gt;FreePack(); line. You shouldn't need it when creating a game that will use the same sampleset. </dd></dl>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Aug 29 2012 18:07:25 for WSF by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.2 </li>
  </ul>
</div>
</body>
</html>
